y = factor(1 + 3 - as.numeric(LC)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
ggplot() +
geom_rect(data = df.best.sum,
aes(xmin = Etot.threshold.min,
xmax = Etot.threshold.max,
ymin = -Inf,ymax = Inf),
fill = "grey", color = NA, alpha = 0.5) +
geom_rect(data = df.best.sum,
aes(ymin = MAP.threshold.min,
ymax = MAP.threshold.max,
xmin = -Inf,xmax = Inf),
fill = "grey", color = NA, alpha = 0.5) +
geom_hline(data = df.best.sum,
aes(yintercept = MAP.threshold.MEM),
color = "grey17") +
geom_vline(data = df.best.sum,
aes(xintercept = Etot.threshold.MEM),
color = 'grey17') +
geom_point(data = Clim.Mask.MCWD.sum %>%
filter(model == "MEM"),
aes(x = Etot_quarter_hot,y = MAP, color = as.factor(LC)),
size = 0.25, alpha = 0.5) +
scale_color_manual(values = c("#c49402","#005401","#448704","grey")) +
theme_bw() +
theme(text = element_text(size = 20)) +
guides(color = "none") +
labs(x = "", y = "")
ggplot() +
# geom_rect(data = df.best.sum,
#           aes(xmin = Etot.threshold.min,
#               xmax = Etot.threshold.max,
#               ymin = -Inf,ymax = Inf),
#           fill = "grey", color = NA, alpha = 0.5) +
#
# geom_rect(data = df.best.sum,
#           aes(ymin = MAP.threshold.min,
#               ymax = MAP.threshold.max,
#               xmin = -Inf,xmax = Inf),
#           fill = "grey", color = NA, alpha = 0.5) +
geom_hline(data = df.best.sum,
aes(yintercept = MAP.threshold.MEM),
color = "grey17") +
geom_vline(data = df.best.sum,
aes(xintercept = Etot.threshold.MEM),
color = 'grey17') +
geom_point(data = Clim.Mask.MCWD.sum %>%
filter(model == "MEM"),
aes(x = Etot_quarter_hot,y = MAP, color = as.factor(LC)),
size = 0.25, alpha = 0.5) +
scale_color_manual(values = c("#c49402","#005401","#448704","grey")) +
theme_bw() +
theme(text = element_text(size = 20)) +
guides(color = "none") +
labs(x = "", y = "")
df2test.Mat
df2test.Mat$LC
df2test.Mat$LC.pred
df2test.Mat <- df2test %>%
group_by(LC,LC.pred) %>%
summarise(N = n(),
area = sum(area*land.frac)/1e12,
.groups = "keep") %>%
ungroup() %>%
complete(LC = factor(1:3,levels = c(2,1,3)),
LC.pred = factor(1:3,levels = c(2,1,3)),
fill = list(N = 0, area = 0)) %>%
mutate(lab = paste("N =",
N),
lab2 = paste(signif(area,2))) %>%
mutate(LC = as.numeric(LC))
df2test.Mat$LC.pred
df2test.Mat$LC
df2test.Mat <- df2test %>%
group_by(LC,LC.pred) %>%
summarise(N = n(),
area = sum(area*land.frac)/1e12,
.groups = "keep") %>%
ungroup() %>%
complete(LC = factor(1:3,levels = c(2,1,3)),
LC.pred = factor(1:3,levels = c(2,1,3)),
fill = list(N = 0, area = 0)) %>%
mutate(lab = paste("N =",
N),
lab2 = paste(signif(area,2))) %>%
mutate(LC = as.numeric(LC),
LC.pred = as.numeric(LC.pred))
ggplot(data = df2test.Mat,
aes(x = as.factor(LC.pred),
y = factor(1 + 3 - as.numeric(LC)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
df2test <- ConfusionM <- Clim.Mask.MCWD.sum %>%
filter(model == "MEM") %>%
filter(LC %in% c(1:3)) %>%
ungroup() %>%
mutate(LC =factor(LC,levels = c(1,2,3)),
LC.pred = factor(case_when(Etot_quarter_hot < Etot.best ~ 2,
MAP < MAP.best ~ 1,
TRUE ~ 3),
levels = c(1,2,3))) %>%
left_join(GridArea,
by = c("lon","lat"))
df2test.Mat <- df2test %>%
group_by(LC,LC.pred) %>%
summarise(N = n(),
area = sum(area*land.frac)/1e12,
.groups = "keep") %>%
ungroup() %>%
complete(LC = factor(1:3,levels = c(2,1,3)),
LC.pred = factor(1:3,levels = c(2,1,3)),
fill = list(N = 0, area = 0)) %>%
mutate(lab = paste("N =",
N),
lab2 = paste(signif(area,2)))
ggplot(data = df2test.Mat,
aes(x = as.factor(LC.pred),
y = factor(1 + 3 - as.numeric(LC)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
df2test.Mat
df2test.Mat$LC
df2test <- ConfusionM <- Clim.Mask.MCWD.sum %>%
filter(model == "MEM") %>%
filter(LC %in% c(1:3)) %>%
ungroup() %>%
mutate(LC =factor(LC,levels = c(1,2,3)),
LC.pred = factor(case_when(Etot_quarter_hot < Etot.best ~ 2,
MAP < MAP.best ~ 1,
TRUE ~ 3),
levels = c(1,2,3))) %>%
left_join(GridArea,
by = c("lon","lat"))
df2test.Mat <- df2test %>%
group_by(LC,LC.pred) %>%
summarise(N = n(),
area = sum(area*land.frac)/1e12,
.groups = "keep") %>%
ungroup() %>%
complete(LC = factor(1:3,levels = c(1,2,3)),
LC.pred = factor(1:3,levels = c(1,2,3)),
fill = list(N = 0, area = 0)) %>%
mutate(lab = paste("N =",
N),
lab2 = paste(signif(area,2)))
ggplot(data = df2test.Mat,
aes(x = as.factor(LC.pred),
y = factor(1 + 3 - as.numeric(LC)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
df2test.Mat$LC
df2test.Mat
ggplot(data = df2test.Mat,
aes(x = factor(LC.pred,
levels = c(2,3,1)),
y = factor(1 + 3 - as.numeric(LC),
levels = c(2,3,1)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
ggplot(data = df2test.Mat,
aes(x = factor(LC.pred,
levels = c(2,3,1)),
y = factor(LC,
levels = c(2,3,1)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
ggplot(data = df2test.Mat,
aes(x = factor(LC.pred,
levels = c(2,3,1)),
y = factor(1 + 3 - as.numeric(LC),
levels = c(2,3,1)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
ggplot(data = df2test.Mat,
aes(x = factor(1 + 3 - as.numeric(LC.pred),
levels = c(2,3,1))),
y = factor(1 + 3 - as.numeric(LC),
levels = c(2,3,1)))) +
ggplot(data = df2test.Mat,
aes(x = factor(1 + 3 - as.numeric(LC.pred),
levels = c(2,3,1))),
y = factor(1 + 3 - as.numeric(LC),
levels = c(2,3,1))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
ggplot(data = df2test.Mat,
aes(x = factor(1 + 3 - as.numeric(LC.pred),
levels = c(2,3,1))),
y = factor(1 + 3 - as.numeric(LC),
levels = c(2,3,1))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
ggplot(data = df2test.Mat,
aes(x = factor(1 + 3 - as.numeric(LC.pred),
levels = c(2,3,1)),
y = factor(1 + 3 - as.numeric(LC),
levels = c(2,3,1)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
ggplot(data = df2test.Mat,
aes(x = factor(1 + 3 - as.numeric(LC.pred),
levels = c(2,3,1)),
y = factor(LC
levels = c(2,3,1)))) +
ggplot(data = df2test.Mat,
aes(x = factor(1 + 3 - as.numeric(LC.pred),
levels = c(2,3,1)),
y = factor(LC,
levels = c(2,3,1)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
df2test.Mat <- df2test %>%
group_by(LC,LC.pred) %>%
summarise(N = n(),
area = sum(area*land.frac)/1e12,
.groups = "keep") %>%
ungroup() %>%
complete(LC = factor(1:3,levels = c(1,2,3)),
LC.pred = factor(1:3,levels = c(1,2,3)),
fill = list(N = 0, area = 0)) %>%
mutate(lab = paste("N =",
N),
lab2 = paste(signif(area,2)))
ggplot(data = df2test.Mat,
aes(x = as.factor(LC.pred),
y = factor(1 + 3 - as.numeric(LC)))) +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
ggplot(data = df2test.Mat,
aes(x = LC.pred
y = LC))  +
ggplot(data = df2test.Mat,
aes(x = LC.pred,
y = LC))  +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
LC.pred
df2test.Mat
ggplot(data = df2test.Mat %>%
mutate(LC2plot = case_when(LC == 1 ~ 3,
LC == 2 ~ 1,
LC == 3 ~ 2),
LC.pred2plot = case_when(LC.pred == 1 ~ 3,
LC.pred == 2 ~ 1,
LC.pred == 3 ~ 2)),
aes(x = LC.pred2plot,
y = LC2plot))  +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
ggplot(data = df2test.Mat %>%
mutate(LC2plot = case_when(LC == 1 ~ 3,
LC == 2 ~ 1,
LC == 3 ~ 2),
LC.pred2plot = case_when(LC.pred == 1 ~ 1,
LC.pred == 2 ~ 3,
LC.pred == 3 ~ 2)),
aes(x = LC.pred2plot,
y = LC2plot))  +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
df2test.Mat
ggplot(data = df2test.Mat %>%
mutate(LC2plot = case_when(LC == 1 ~ 1,
LC == 2 ~ 3,
LC == 3 ~ 2),
LC.pred2plot = case_when(LC.pred == 1 ~ 3,
LC.pred == 2 ~ 1,
LC.pred == 3 ~ 2)),
aes(x = LC.pred2plot,
y = LC2plot))  +
geom_tile(aes(fill = area),
color = "black",
size = 0.5) +
scale_fill_gradient(low = "white",
high = "grey32") +
geom_label(aes(label = lab2), fill = NA,
label.size = NA) +
theme_minimal() +
scale_x_discrete(breaks = c()) +
scale_y_discrete(breaks = c()) +
guides(fill = "none") +
coord_equal() +
labs(x="",y = "") +
theme(text = element_text(size = 40),
axis.text.x = element_text(angle = 360-45, vjust = 0, hjust=1),
panel.grid = element_blank())
df2test.Mat
ggplot(df.CM %>%
filter(model == "MEM"),
aes(x = MAP.threshold, y = Etot.threshold,
fill = Acc, z = Acc)) +
geom_raster() +
geom_contour(color = "black",
linewidth = 0.3) +  # Contour lines
geom_text_contour(stroke = 0.2, size = 3) +  # adds labels
scale_fill_viridis_c(option = "D",  # options: "A", "B", "C", "D", "E", "magma", "inferno", etc.
direction = 1) +   # legend title
labs(fill = "Accuracy") +
labs(x = "", y = "", fill = "") +
theme_bw() +
theme(text = element_text(size = 20))
